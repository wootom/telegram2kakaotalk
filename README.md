# 텔레그램-카카오톡 포워더 (Telegram to KakaoTalk Forwarder)

텔레그램 **vaax notifier** 등 특정 소스에서 오는 메시지를 **카카오톡 채팅방(VAAX, FOVEA 등)**으로 자동 전달하는 시스템입니다.

## ✨ 주요 기능

*   **다중 전송 (1:N Broadcasting)**: 하나의 텔레그램 소스를 여러 카카오톡 방으로 동시에 전송 가능합니다.
*   **웹 관리자 페이지**: 브라우저에서 쉽고 간편하게 연결 설정을 추가/삭제할 수 있습니다.
*   **실시간 모니터링**: 터미널에서 작동 상태를 바로 확인할 수 있습니다.

## 📁 프로젝트 구조

```
vaax-telegram/
├── main.py                    # **실행 파일** (텔레그램 리스너 + 웹 서버 동시 실행)
├── telegram_listener.py       # 텔레그램 메시지 감지 및 방송(Broadcasting)
├── kakao_sender.py            # 카카오톡 메시지 전송 (AppleScript 기반)
├── web_admin.py               # 웹 관리자 페이지 (Flask 서버, 포트 5001)
├── settings.json              # 설정 저장소 (소스-타겟 매핑 정보)
├── config.py                  # API 자격 증명 (API_ID, API_HASH)
├── vaax_session.session       # 텔레그램 세션 파일 (초기 실행 시 생성됨)
└── requirements.txt           # Python 의존성 라이브러리
```

## 🚀 사용 방법 (터미널 실행)

이 프로그램은 **터미널에서 직접 실행**하는 것이 가장 안정적입니다. (macOS 권한 문제 해결)

### 1. 실행하기

터미널을 열고 다음 명령어를 입력하세요:

```bash
cd ~/Documents/Code/vaax-telegram
python3 main.py
```

실행하면 아래와 같은 로그가 나옵니다:
```
---------------------------------------------------
   Telegram to KakaoTalk Forwarder Started
---------------------------------------------------
🌍 Web Admin running at http://127.0.0.1:5001
Initialize Telegram Client...
...
```

**⚠️ 주의**: 이 터미널 창을 **끄지 말고 켜두셔야** 메시지가 전송됩니다. (최소화는 괜찮음)

### 2. 웹 설정 페이지 접속

브라우저(크롬, 사파리 등)에서 아래 주소로 접속하세요:

👉 **[http://127.0.0.1:5001](http://127.0.0.1:5001)**

여기서 할 수 있는 것:
*   **최근 감지된 소스**: 텔레그램에서 메시지가 오면 리스트에 뜹니다. 클릭해서 바로 추가하세요.
*   **연결 추가/삭제**: `소스(텔레그램)` ➡ `타겟(카카오톡)` 연결을 자유롭게 설정합니다.
*   **다중 전송 설정**: 같은 소스에 타겟을 여러 개 추가하면, 한 번에 여러 곳으로 보냅니다.

## ⚙️ 필수 조건 (설정)

### 1. macOS 권한 설정
**시스템 설정 → 개인 정보 보호 및 보안**에서:
*   **손쉬운 사용 (Accessibility)**: `Terminal` (또는 `iTerm`) 앱에 권한을 허용해야 합니다.
*   (권한이 없으면 "Access Denied" 오류가 발생하며 전송에 실패합니다.)

### 2. 카카오톡 창 설정 (⚠️ 매우 중요)
메시지를 보낼 카카오톡 채팅방(예: `VAAX`, `FOVEA`)은 반드시 **별도 창으로 열려 있어야** 합니다.

1. 카카오톡 메인 리스트에서 채팅방을 **더블 클릭**합니다.
2. 독립된 창이 뜨면, 화면 구석에 잘 둡니다. (창을 최소화하거나 닫으면 안 됩니다!)
3. 다른 창에 가려져 있어도 괜찮습니다. (전송 시 잠깐 앞으로 나왔다가 다시 돌아갑니다.)

## 🔄 동작 원리

1. **감지**: `main.py`가 텔레그램 메시지를 실시간으로 감시합니다.
2. **매칭**: 메시지가 오면 `settings.json`을 확인하여 어디로 보낼지 결정합니다.
3. **전송**: `kakao_sender.py`가 AppleScript를 이용해 카카오톡 창에 메시지를 입력하고 엔터를 칩니다.

## ❓ 문제 해결

### Q: "Access Denied" 오류가 떠요.
**A:** 터미널(Terminal) 앱에 **손쉬운 사용** 권한이 있는지 확인하세요. 만약 이미 체크되어 있다면, 체크를 해제했다가 다시 체크해보세요.

### Q: 메시지는 오는데 카카오톡으로 안 가요.
**A:**
1. 카카오톡 채팅방 창이 열려 있는지 확인하세요.
2. 채팅방 이름이 웹 설정 페이지에 등록된 이름과 **정확히 일치**하는지 확인하세요. (띄어쓰기 포함)

---
**작성일**: 2026-02-07
**업데이트**: Manual Execution Mode & Web Admin Added
